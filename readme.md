# Тестовое задание для Clevertec

## Описание
Консольное приложение, реализующее функционал формирования чека в магазине. Также был реализован RESTFUL-интерфейс на 
Spring Boot. Для консольного приложения реализовано считывание данных о продуктах и скидочных картах из файлов. Для всех интерфейсов (консоль, RESTFUL)
реализована запись чека в файл. 

## Технологии
- Java 17
- Spring Boot
- Hibernate
- PostgreSQL
- Gradle 7.5
- Docker
- Jackson
- JUnit

## Запуск консольного приложения
- Для запуска консольного приложения из папки с проектом (check_runner) необходимо прописать в консоли:
  java build\classes\java\main\com\barkovsky\check_runner\runner\CheckRunner и далее аргументы консоли. Это необходимо для того, чтобы класс CheckRunner мог увидеть все импорты.
- Если необходимо, чтобы происходило считывание данных из файлов, тогда первыми двумя аргументами должны быть: `product-file_product.txt` `discount-file-card.txt`.
  Иначе будут использоваться данные, объявленные в коде.
- Аргумент `1-10` означает, что будет добавлен в чек продукт с id = 1 в количестве 10 штук.
- Если необходимо добавить скидочную карту, тогда передается аргумент: `card-1111`. Он означает, что будет использована карта с id = 1111.
- После каждого получения чека в консоль также печается в файл, который будет находиться в корневой папке проекта. 

## Запуск приложения на Sping Boot

Для формирования чека RESTFUL-интерфейсу нужно передавать Map<String, String> в формате JSON. Запись `"1": "2"` означает, что был передан товар с id = 1 в количестве 2 штук. 
Запись `"card": "1111"` означает, что была передана скидочная карта с id = 1111. Пример:
```json
   {
    "1": "10",
    "5": "4",
    "3": "15",
    "8": "1",
    "card": "2222"
   }
```

### Обычный запуск
1. Сначала нужно загрузить ddl-файл в PostgreSQL. Для этого нужно создать database с названием "check_runner" в pgAdmin и через Query Tool создать схему и таблицы для данных. 
   Они находятся в файле schema.sql. Затем необходимо заполнить их данными. SQL-код для этого находится в data.sql.
2. Проект можно запустить через среду разработки или сделать gradle build и использовать jar-файл.

### Запуск через docker
1. Создать jar-файл проекта через gradle build. Здесь могут возникнуть проблемы с подключением к БД. Для подключения к PostgreSQL требуется изменение хоста с localhost на db
(порт остается тем же). Если после изменения хоста перестанут проходить unit-тесты, тогда собрать проект можно с помощью команды: `gradle build -x test`.
2. Затем запускаем `docker-compose.yml`. Будут созданы изображения для PostgreSQL, pgAdmin и java-проекта и подняты контейнеры.
3. Чтобы подключится к pgAdmin, нужно использовать localhost:8082. Данные для подключения указаны в docker-compose.yml.    